<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"><title>Manage Doctors - Admin Panel</title>
</head>
<body style="font-family:Segoe UI;background:#f4f7f6;margin:0;padding:20px;">
<div style="max-width:1100px;margin:auto;background:#fff;padding:30px;border-radius:8px;box-shadow:0 4px 6px rgba(0,0,0,.1);">
  <h2 style="color:#2c3e50;border-bottom:2px solid #5dade2;padding-bottom:10px;">Manage Doctors</h2>

  <!-- Department filter -->
  <form th:action="@{/admin/manage-doctors}" method="get" style="margin:10px 0;display:flex;gap:10px;align-items:center;">
    <label>Filter by Department:</label>
    <select name="departmentId">
      <option th:value="" th:selected="${selectedDepartmentId == null}">All</option>
      <option th:each="d : ${departments}"
              th:value="${d.id}"
              th:text="${d.deptName}"
              th:selected="${selectedDepartmentId != null and selectedDepartmentId == d.id}">
      </option>
    </select>
    <button type="submit">Apply</button>
    <a th:href="@{/admin/manage-doctors}" style="margin-left:10px;">Clear</a>
    <a th:href="@{/admin/add-doctor}" style="margin-left:auto;background:#27ae60;color:#fff;padding:8px 12px;border-radius:4px;text-decoration:none;">Add New Doctor</a>
  </form>

  <table style="width:100%;border-collapse:collapse;margin-top:10px;">
    <thead>
      <tr style="background:#f8f9fa;color:#34495e;">
        <th style="padding:12px;border-bottom:1px solid #ddd;">ID</th>
        <th style="padding:12px;border-bottom:1px solid #ddd;">Name</th>
        <th style="padding:12px;border-bottom:1px solid #ddd;">Qualification</th>
        <th style="padding:12px;border-bottom:1px solid #ddd;">Username</th>
        <th style="padding:12px;border-bottom:1px solid #ddd;">Department</th>
        <th style="padding:12px;border-bottom:1px solid #ddd;">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="doctor : ${listOfDoctors}">
        <td th:text="${doctor.id}" style="padding:10px;border-bottom:1px solid #eee;"></td>
        <td th:text="${doctor.name}" style="padding:10px;border-bottom:1px solid #eee;"></td>
        <td th:text="${doctor.qualification}" style="padding:10px;border-bottom:1px solid #eee;"></td>
        <td th:text="${doctor.user != null ? doctor.user.username : '—'}" style="padding:10px;border-bottom:1px solid #eee;"></td>
        <td th:text="${doctor.department != null ? doctor.department.deptName : '—'}" style="padding:10px;border-bottom:1px solid #eee;"></td>
        <td style="padding:10px;border-bottom:1px solid #eee;">
          <a th:href="@{/admin/edit-doctor/{id}(id=${doctor.id})}" style="background:#2980b9;color:#fff;padding:6px 10px;border-radius:4px;text-decoration:none;margin-right:6px;">Edit</a>
          <form th:action="@{/admin/delete-doctor/{id}(id=${doctor.id})}" method="post" style="display:inline;">
            <button type="submit" style="background:#c0392b;color:#fff;padding:6px 10px;border:none;border-radius:4px;"
                    onclick="return confirm('Delete this doctor?')">Delete</button>
          </form>
        </td>
      </tr>
      <tr th:if="${#lists.isEmpty(listOfDoctors)}">
        <td colspan="6" style="padding:10px;">No doctors found.</td>
      </tr>
    </tbody>
  </table>
</div>
</body>
</html>